---
title: "Quickstart"
description: Build your first agentic workflow in less than 30 seconds
icon: rocket
---


Welcome to ControlFlow! This quickstart guide will walk you through the basics of using ControlFlow to create AI-powered workflows, culminating in a practical email processing application.

## Install ControlFlow

Install ControlFlow with pip:

```bash
pip install controlflow
```

Configure your preferred LLM provider. By default, ControlFlow uses OpenAI, so you'll need to set your API key:

```bash
export OPENAI_API_KEY="your-api-key"
```

To use another provider, see the docs on [configuring LLMs](/guides/llms). Note that one of the agents in this quickstart is configured with OpenAI's GPT-4o-mini model; you can change the model name to whatever you prefer.

## Quickstart setup

In this quickstart, we're going to create a simple email processing workflow. To make the quickstart code easier to read, we'll begin by creating a few example emails here. You should execute this code in your own Python interpreter before running the quickstart examples.

Feel free to replace the emails with your own content to see how ControlFlow works with different inputs.

```python
emails = [
    "Hello, I need an update on the project status.",
    "Subject: Exclusive offer just for you!",
    "Urgent: Project deadline moved up by one week.",
]
```

## Running a simple task

Let's start with the basics. The `cf.run()` function is the main entry point for ControlFlow. It creates a task, assigns it to the default agent, and runs it to completion.

Here, we create a task that generates a simple email reply, and provide the content of an email as additional context.

<CodeGroup>
```python Code
import controlflow as cf

# Create a ControlFlow task to generate an reply
reply = cf.run(
    "Write a polite reply to an email",
    context=dict(email=emails[0]),
)

print(reply)
```

```text Result
Dear [Recipient's Name],

Thank you for reaching out. I appreciate your patience.

I wanted to inform you that the project is progressing 
well. We have completed several key milestones and are 
currently working on the next phase. We anticipate 
meeting our deadlines and will keep you updated with 
any new developments.

Please feel free to reach out if you have any further 
questions or need additional information.

Best regards,

[Your Name]
```
</CodeGroup>

## Creating specialized agents

We've seen how to instruct the default agent to perform a task, but what if we want to perform a task that requires a specialized agent? We can create a new agent with its own model, instructions, or tools.

In this example, we'll use an agent to categorize emails. This agent uses a smaller, faster model than the default agent, and it has specialized instructions for the task.

<Tip>
Not using OpenAI? You can use any LangChain-compatible LLM here. Follow the instructions in the [LLM docs](/guides/llms) to learn more.
</Tip>

In addition, note that we're instructing the agent to return a list of `EmailCategory` objects. ControlFlow will automatically convert the result into the appropriate data type. The `result_type` field supports any Pydantic-compatible type as well as lists of objects when you want the model to choose one of several options.

<CodeGroup>
```python Code
from langchain_openai import ChatOpenAI
from enum import Enum

# Create a specialized agent 
classifier = cf.Agent(
    name="Email Classifier",
    model=ChatOpenAI(model="gpt-4o-mini"),
    instructions="You are an expert at quickly classifying emails.",
)

# Set up a ControlFlow task to classify emails
class EmailCategory(str, Enum):
    IMPORTANT = "important"
    SPAM = "spam"

categories = cf.run(
    'Classify the emails',
    result_type=list[EmailCategory],
    agents=[classifier],
    context=dict(emails=emails),
)

print(categories)
```

```text Result
[
    EmailCategory.IMPORTANT,
    EmailCategory.SPAM,
    EmailCategory.IMPORTANT,
]
```
</CodeGroup>

Our agent correctly identifies the first and third emails as important, and the second as spam.

## Composing tasks into a flow

Thus far, each of our tasks has run as a one-off operation. To create a more complex workflow, we can use a ControlFlow flow.

A flow provides a shared context and history for all agents, even across multiple tasks. The easiest way to create a flow is to use the `@cf.flow` decorator on a function with ControlFlow agents working inside it.

<CodeGroup>
```python Code
import controlflow as cf
from langchain_openai import ChatOpenAI
from enum import Enum

class EmailCategory(str, Enum):
    IMPORTANT = "important"
    SPAM = "spam"

# Create agents
classifier = cf.Agent(
    name="Email Classifier",
    model=ChatOpenAI(model="gpt-4o-mini"),
    instructions="You are an expert at quickly classifying emails. Always "
                 "respond with exactly one word: either 'important' or 'spam'."
)

responder = cf.Agent(
    name="Email Responder",
    model=ChatOpenAI(model="gpt-4o"),
    instructions="You are an expert at crafting professional email responses. "
                 "Your replies should be concise but friendly."
)

# Create the flow
@cf.flow
def process_email(email_content: str):
    # Classify the email
    category = cf.run(
        f"Classify this email",
        result_type=EmailCategory,
        agents=[classifier],
        context=dict(email=email_content),
    )

    # If the email is important, write a response
    if category == EmailCategory.IMPORTANT:
        response = cf.run(
            f"Write a response to this important email",
            result_type=str,
            agents=[responder],
            context=dict(email=email_content),
        )
        return response
    else:
        print("No response needed for spam email.")


# Run the flow on each email
for email in emails:
    response = process_email(email)
    print(response)
```

```text Response to Email 1
Dear [Recipient's Name],

I'm glad to report that the project is progressing well. We have 
completed several key milestones and are currently working on the 
next phase. We anticipate meeting our deadlines and will keep you 
updated with any new developments.

Please feel free to reach out if you have any further questions 
or need additional information.

Best regards,

[Your Name]
```

```text Response to Email 2
<No response needed for spam email.>
```

```text Response to Email 3
Dear [Recipient's Name],

Thanks for letting me know. We'll make sure to adjust our plans accordingly.

Best regards,
[Your Name]
```
</CodeGroup>

## Review

Congratulations! You've completed the ControlFlow quickstart. You've learned how to:

1. Run simple tasks with `cf.run()`
2. Create specialized agents for specific tasks
3. Compose tasks into complex workflows using flows

This email processing example showcases how ControlFlow can be used to create sophisticated AI-powered applications. As you continue to explore ControlFlow, you'll discover even more ways to leverage AI in your projects.

To dive deeper into ControlFlow's capabilities, check out:

- [Agent concepts](/concepts/agents) to learn about creating powerful, specialized agents
- [Task concepts](/concepts/tasks) for more on defining and customizing tasks
- [Flow concepts](/concepts/flows) for advanced workflow orchestration techniques
- [Using tools](/guides/tools) to extend agent capabilities
- [Chatting with agents](/guides/chat) to create interactive experiences
- [Agent collaboration](/guides/collaboration) to coordinate agents across multiple tasks and flows

Happy engineering!